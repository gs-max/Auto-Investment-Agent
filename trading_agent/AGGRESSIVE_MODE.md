# ⚡ 激进高频交易模式

## 🎯 已完成的改动

你的系统已经从**保守模式**升级为**激进高频交易模式**！

### ✅ 配置调整

| 参数 | 旧值（保守） | 新值（激进） | 说明 |
|------|-------------|-------------|------|
| **可用资金** | $100 | $999 | 使用全部账户资金 |
| **单笔限额** | $50 | $200 | 允许更大交易 |
| **仓位占比** | 10% | 30% | 单币种可用更多资金 |
| **总仓位** | 50% | 80% | 允许更高总持仓 |
| **允许币种** | ["BTC", "ETH"] | [] (无限制) | 可交易所有币种 |
| **最大杠杆** | 3x | 10x | 允许更高杠杆 |
| **检查间隔** | 300秒 | 60秒 | 高频检查 |

### ✅ 策略调整

**旧策略（保守）**：
```
- 等待明确信号才交易
- 优先观望 (hold)
- 质疑"异常"价格
- 长期持有
- 低杠杆
```

**新策略（激进）**：
```
✅ 主动寻找交易机会
✅ 禁止长时间观望
✅ 忽略价格"异常"（测试网正常）
✅ 快进快出（2-5%止盈）
✅ 充分利用杠杆（5-10x）
✅ 高频交易（每小时1-2笔）
```

---

## 🚀 如何运行

### **方式 1: 直接启动（推荐）**

```bash
# 高频交易模式（60秒检查）
python main_advanced.py

# 查看实时日志
tail -f logs/advanced_trading.log
```

### **方式 2: 自定义参数**

```bash
# 超高频（30秒检查）
python main_advanced.py --interval 30

# 单次测试
python main_advanced.py --mode once

# 使用保守策略（临时切换）
python main_advanced.py --strategy config/advanced_strategy_prompt.txt
```

---

## 📊 预期运行效果

### **启动日志**

```
🚀 高频交易 Agent 启动 - 激进模式
====================================================================
📌 功能: 杠杆 | 止盈止损 | 技术分析 | 高频交易
⚡ 模式: 激进策略 | 60秒检查 | 无币种限制
====================================================================
💰 账户余额: $999.00 USDC
💵 可用资金: $999.00 USDC (100.0%)
🎯 最大杠杆: 10x
🪙 允许币种: 所有币种
⚡ 检查间隔: 60秒
====================================================================
🔴 真实交易模式：请谨慎！
```

### **高频交易示例**

```
【第 1 轮】- 10:00:00
BTC: $112,586, RSI: 48, 24h: +0.8%
决策: BUY 0.01 BTC, 3x杠杆
✅ 买入成功，设置止盈 3% / 止损 1.5%

【第 2 轮】- 10:01:00  
ETH: $3,456, RSI: 52, 24h: -0.3%
决策: SELL 0.1 ETH, 2x杠杆（做空）
✅ 开空成功

【第 3 轮】- 10:02:00
BTC 持仓盈利 2.5%
决策: CLOSE BTC
✅ 平仓成功，获利 $6.75

【第 4 轮】- 10:03:00
SOL: $150, RSI: 35, 波动率: 0.018
决策: BUY 0.5 SOL, 5x杠杆
✅ 买入成功（新币种探索）
```

---

## 🎯 LLM 决策逻辑变化

### **对比：保守 vs 激进**

#### **场景 1: BTC "异常"高价**

**保守模式** ❌：
```
BTC: $112,586（异常价格）
→ 决策: HOLD
→ 理由: "价格异常，等待数据恢复正常"
```

**激进模式** ✅：
```
BTC: $112,586（测试网正常价格）
RSI: 52, 24h: -0.5%
→ 决策: SELL 0.001 BTC, 2x杠杆
→ 理由: "价格是测试网环境，属于正常。RSI 52中性偏上，
         24h下跌0.5%显示弱势，做空捕捉下跌"
```

#### **场景 2: 无明确信号**

**保守模式** ❌：
```
ETH: RSI 50, 24h: 0%, 趋势: neutral
→ 决策: HOLD
→ 理由: "信号不明确，观望"
```

**激进模式** ✅：
```
ETH: RSI 50, 24h: 0%, 波动率: 0.012
→ 决策: BUY 0.01 ETH, 1x杠杆
→ 理由: "虽然指标中性，但波动率0.012显示市场活跃。
         小仓位试探市场，设置2%止盈1%止损"
```

#### **场景 3: 小幅上涨**

**保守模式** ❌：
```
BTC: 24h +0.8%, RSI: 48
→ 决策: HOLD
→ 理由: "涨幅不足2%，等待更强信号"
```

**激进模式** ✅：
```
BTC: 24h +0.8%, RSI: 48
→ 决策: BUY 0.01 BTC, 3x杠杆
→ 理由: "RSI 48接近中性，24h小幅上涨0.8%显示轻微上升趋势。
         使用3x杠杆捕捉短期波动"
```

---

## 🎲 激进策略核心规则

### **1. 买入信号（满足任意一条）**

```
✅ RSI < 50
✅ 24h 涨幅 > 0%
✅ 价格突破 SMA(20)
✅ EMA(12) > SMA(20)
✅ 波动率 > 0.01
✅ 无持仓且市场有波动
```

### **2. 卖出/做空信号（满足任意一条）**

```
✅ RSI > 50
✅ 24h 跌幅 > 0%
✅ 价格跌破 SMA(20)
✅ EMA(12) < SMA(20)
✅ 持仓盈利 > 2%
✅ 持仓亏损 > 1.5%
```

### **3. 杠杆选择**

```
强烈信号（RSI<30 或 >70，大涨跌）:
→ 5-10x 杠杆

一般信号（任何方向性指标）:
→ 3-5x 杠杆

试探市场（无明确信号）:
→ 1-2x 杠杆
```

### **4. 止盈止损（强制）**

```
快进快出：
- 止盈: 2-5%（小利润就跑）
- 止损: 1-2%（严格止损）

每笔交易必须设置！
```

---

## 📈 预期交易频率

```
时间段          目标交易次数
---------------------------------
每分钟          0-1 笔（检查）
每小时          1-3 笔（交易）
每天（24小时）   24-72 笔
```

**目标胜率**: 55-60%（不需要很高，靠交易量盈利）

---

## ⚠️ 风险控制（虽激进但不无脑）

### **保留的安全机制**

✅ **强制止盈止损**
- 每笔交易必须设置 TP/SL
- 止损严格 1-2%
- 自动触发，不靠人工

✅ **仓位管理**
- 单币种 ≤ 30% 可用资金
- 总持仓 ≤ 80% 可用资金
- 分散风险

✅ **杠杆上限**
- 最大 10x（不会无限杠杆）
- 强烈信号才用高杠杆
- 不确定用低杠杆

✅ **最小账户价值**
- 保留 $10 USDC
- 防止爆仓

### **禁止的操作**

❌ 不设止损
❌ 杠杆 > 10x
❌ 重仓单币种 > 50%
❌ 逆势加仓
❌ 连亏后继续高杠杆

---

## 🧪 测试建议

### **第1天：观察模式**

```bash
# 先看一天，不执行
修改 config.testnet.json:
"enable_execution": false

python main_advanced.py
```

观察：
- LLM 每分钟做什么决策？
- 是否太激进或太保守？
- 交易频率如何？

### **第2天：小额真实**

```bash
# 降低可用资金测试
修改 config.testnet.json:
"max_usable_capital": 100,
"enable_execution": true

python main_advanced.py
```

观察：
- 实际盈亏如何？
- 止损是否生效？
- 杠杆使用是否合理？

### **第3天：全面运行**

```bash
# 放开限制
"max_usable_capital": 999,

python main_advanced.py
```

---

## 📊 监控和调试

### **实时监控**

```bash
# 终端1：运行 Agent
python main_advanced.py

# 终端2：实时日志
tail -f logs/advanced_trading.log

# 终端3：筛选交易
grep "真实交易" logs/advanced_trading.log
grep "决策:" logs/advanced_trading.log
```

### **关键指标**

每天检查：
```
✅ 总交易次数（目标: 20-40）
✅ 胜率（目标: >55%）
✅ 平均持仓时间（目标: <1小时）
✅ 最大单笔亏损（应 ≤ 2%）
✅ 总盈亏
```

---

## 🎓 心态调整

### **激进 ≠ 无脑**

```
✅ 正确理解：
- 主动寻找机会
- 接受小亏损
- 快速止损止盈
- 通过交易量提高胜率

❌ 错误理解：
- 无脑梭哈
- 不设止损
- 逆势死扛
- 情绪化交易
```

### **测试网心态**

```
这是学习环境：
✅ 大胆尝试不同策略
✅ 记录每次交易结果
✅ 分析失败原因
✅ 优化参数

不是真实资金：
✅ 可以承受亏损
✅ 重点是学习过程
✅ 提高交易技能
```

---

## 🚦 随时可以切换模式

### **回到保守模式**

```bash
# 修改配置
vim config/config.testnet.json

"max_usable_capital": 100,
"allowed_coins": ["BTC", "ETH"],
"max_leverage": 3,

# 使用保守策略
python main_advanced.py --strategy config/advanced_strategy_prompt.txt --interval 300
```

### **调整激进程度**

```bash
# 中等激进（推荐新手）
"max_leverage": 5,
"max_single_trade_value": 100,
--interval 120

# 超级激进（经验丰富）
"max_leverage": 10,
"max_single_trade_value": 200,
--interval 30
```

---

## 📞 常见问题

### Q1: 为什么不质疑 $112,586 的 BTC 价格？

**A**: 测试网价格可能与主网不同，这很正常。重要的是**价格变化方向**，不是绝对值。

### Q2: 会不会交易太频繁？

**A**: 高频交易的本质就是频繁。目标是通过多次交易提高总体胜率，而不是单笔暴利。

### Q3: 杠杆太高会不会爆仓？

**A**: 有严格止损（1-2%），即使 10x 杠杆，最大亏损也只是 10-20% 本金。

### Q4: 所有币种都能交易吗？

**A**: 是的，空数组 `[]` 表示不限制。但 LLM 会优先选择主流币种。

### Q5: 如何停止？

**A**: 
```bash
# 按 Ctrl+C
# 或设置配置
"enable_execution": false
```

---

## 🎯 开始交易！

```bash
# 1. 确认配置
cat config/config.testnet.json

# 2. 启动
python main_advanced.py

# 3. 监控
tail -f logs/advanced_trading.log
```

**祝交易顺利！记住：激进但不无脑，快速但有纪律！** ⚡📈
