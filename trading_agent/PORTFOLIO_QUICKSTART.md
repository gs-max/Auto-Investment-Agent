# 🚀 多资产组合管理 - 快速开始

## 📋 核心改变

✅ **LLM现在是自由的交易专家**：
- 可以交易任何币种（无限制）
- 每次分析返回2-4个交易决策
- 同时管理3-8个不同资产
- 根据市场变化主动调仓

✅ **投资组合策略**：
- 分散风险到多个资产
- 核心持仓 + 机会持仓 + 对冲持仓
- 智能资金分配
- 动态调整组合

---

## ⚡ 3步开始

### 1️⃣ 测试配置

```bash
python test_portfolio.py
```

**预期输出**：
```
✅ 所有检查通过！
🚀 可以开始使用组合管理模式
```

### 2️⃣ 模拟运行（安全测试）

```bash
python main_portfolio.py --mode once --dry-run
```

**观察重点**：
- LLM是否返回2-4个交易？
- 币种是否多样化（不只是BTC/ETH）？
- 资金是否分散？

### 3️⃣ 真实交易

```bash
python main_portfolio.py --mode once
```

---

## 📊 预期输出示例

```
🎯 投资组合决策
======================================================================

📊 组合分析：
市场处于中性状态，采用多元化策略。分散投资到ETH(核心)、SOL(机会)、
DOGE(高风险)，同时用BTC空单对冲。总投资$350，留$649应急。

📋 计划执行 4 个交易：

1. 📈 买入
   币种: ETH
   数量: 0.04
   杠杆: 2x
   止盈: 3.0% / 止损: 1.5%
   理由: ETH作为核心持仓，稳定可靠
   置信度: 65%

2. 📈 买入
   币种: SOL
   数量: 0.6
   杠杆: 3x
   止盈: 4.0% / 止损: 2.0%
   理由: SOL高波动，捕捉短期机会
   置信度: 70%

3. 📈 买入
   币种: DOGE
   数量: 150
   杠杆: 5x
   止盈: 5.0% / 止损: 2.5%
   理由: DOGE动量强劲，小仓位高杠杆
   置信度: 60%

4. 📉 卖出
   币种: BTC
   数量: 0.001
   杠杆: 2x
   止盈: 3.0% / 止损: 1.5%
   理由: BTC做空作为对冲
   置信度: 55%

======================================================================

🔄 开始执行组合交易
======================================================================
[1/4] 执行: BUY ETH
   ✅ 成功
[2/4] 执行: BUY SOL
   ✅ 成功
[3/4] 执行: BUY DOGE
   ✅ 成功
[4/4] 执行: SELL BTC
   ✅ 成功

======================================================================
📊 执行汇总
======================================================================
成功: 4/4
失败: 0/4
======================================================================
```

---

## ❓ FAQ

### Q: LLM只返回1个交易怎么办？

**A**: 检查是否使用了正确的策略文件：
```bash
python main_portfolio.py --strategy config/portfolio_strategy_prompt.txt
```

### Q: 某些币种无法交易？

**A**: 可能是持仓量达到上限（Open Interest Cap）。LLM会自动尝试其他币种。

### Q: 如何限制币种范围？

**A**: 虽然默认无限制，但你可以在配置中设置：
```json
{
  "risk": {
    "allowed_coins": ["ETH", "SOL", "AVAX", "UNI"]
  }
}
```

### Q: 持续运行模式？

**A**: 使用loop模式，每60秒调整一次组合：
```bash
python main_portfolio.py --mode loop
```

---

## 🎯 成功标准

运行成功的标志：

✅ LLM每次返回**2-4个交易决策**  
✅ 币种**多样化**（不只是BTC）  
✅ 资金**分散**到多个资产  
✅ 有**对冲策略**（多空搭配）  
✅ 根据市场变化**主动调仓**  

---

## 📚 完整文档

- **`PORTFOLIO_MODE.md`** - 详细说明文档
- **`config/portfolio_strategy_prompt.txt`** - LLM策略提示
- **`src/portfolio_nodes.py`** - 技术实现

---

## 🚀 现在开始

```bash
# 1. 测试
python test_portfolio.py

# 2. 模拟运行
python main_portfolio.py --mode once --dry-run

# 3. 真实交易
python main_portfolio.py --mode once
```

**祝交易成功！** 🎉📈
